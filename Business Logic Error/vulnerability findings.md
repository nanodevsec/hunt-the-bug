# 🧠 Business Logic Vulnerability Hunting Cheatsheet

Business logic vulnerabilities occur when applications fail to enforce the intended rules of the business process, often allowing attackers to abuse workflows in unintended ways. These issues require critical thinking and a deep understanding of application flow.

---

## 🛠️ General Mindset

-   Think like both a **user** and an **abuser**.
-   Understand the **intended business workflow**.
-   Look for assumptions: "What if I skip a step?" or "What if I send something unexpected?"

---

## 🔍 Testing Methodology

### 1. **Tamper with Parameters**

-   Remove, change, or duplicate parameters.
-   Modify hidden fields or URL tokens.
-   Test what happens if mandatory parameters are:
    -   Omitted
    -   Left empty
    -   Set to null or unexpected types

---

### 2. **Manipulate Workflow Sequence**

-   Access steps out of order.
-   Skip or replay steps.
-   Perform a step multiple times (e.g., re-use a confirmation page).
-   Observe how the app reacts to inconsistent or partial states.

---

### 3. **Submit Unconventional Input**

-   Input extreme values (e.g., negative numbers, large numbers).
-   Try unsupported data types or malformed input.
-   Use unexpected characters or encodings.
-   Submit very long strings or missing fields.

---

### 4. **Assume the Role of a Malicious Insider**

-   What would a disgruntled or curious user do?
-   Explore post-authenticated areas with modified roles or states.

---

### 5. **Bypass Client-Side Controls**

-   Use tools like Burp Suite to:
    -   Remove client-side validation.
    -   Modify intercepted requests.
    -   Replay requests in different states.

---

## 🧪 Specific Test Cases

| Category                 | Technique                                        | Description                            |
| ------------------------ | ------------------------------------------------ | -------------------------------------- |
| **Parameter Abuse**      | Remove or rename parameters                      | Access alternate logic branches        |
|                          | Change `role=admin` to `role=user` or vice versa | Try privilege escalation               |
| **State Manipulation**   | Skip steps in multi-step forms                   | Tamper with flow logic                 |
|                          | Re-use expired or one-time-use tokens            | Check for reuse flaws                  |
| **Numerical Flaws**      | Send negative or zero quantity in shopping cart  | May result in refund, overcredit, etc. |
|                          | Overflow inventory/order quantities              | Bypass thresholds                      |
| **Discount Logic**       | Apply discount, then remove items                | Get benefits without meeting criteria  |
| **2FA / Auth Flaws**     | Try accessing 2FA-protected pages directly       | Bypass 2FA if server doesn't re-check  |
| **Insecure Assumptions** | Assume user will behave "correctly"              | Force edge conditions intentionally    |
| **Dual-Use Endpoints**   | Access endpoint with different roles or states   | Trigger unintended functions           |

---

## 🚩 Common Red Flags

-   Does the server rely heavily on client-side logic?
-   Are business rules inconsistently applied across endpoints?
-   Can you submit or replay requests in unintended ways?
-   Does the app allow unusual input without validation?

---

## 🧰 Recommended Tools

-   **Burp Suite** (Proxy, Repeater, Intruder)
-   **Postman** (for API logic testing)
-   **FoxyProxy** (to switch profiles quickly)
-   **Custom Scripts** (Python, Bash for automation)

---

## 📚 Useful References

-   [PortSwigger – Business Logic Vulnerabilities](https://portswigger.net/web-security/logic-flaws)
-   [OWASP Top 10 – A01:2021 – Broken Access Control](https://owasp.org/Top10/A01_2021-Broken_Access_Control/)
-   [Gareth Heyes – Email Parser Discrepancy Paper](https://portswigger.net/research/splitting-the-email-atom)

---

> 💡 **Pro Tip:** Business logic bugs are **context-dependent**. Immerse yourself in the app, map the flow, take notes, and always challenge the assumptions made by developers.
